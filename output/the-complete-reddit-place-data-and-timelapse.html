<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>"The Complete Reddit Place Data and Timelapse"</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Fighting the System </a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/misc.html">misc</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/the-complete-reddit-place-data-and-timelapse.html" rel="bookmark"
           title="Permalink to "The Complete Reddit Place Data and Timelapse"">"The Complete Reddit Place Data and Timelapse"</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-04-17T15:45:27-05:00">
                Published: Mon 17 April 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/webbrashearme.html">web@brashear.me</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>.</p>

</footer><!-- /.post-info -->      <p>After place ended I became fascinated with the time lapses. Unfortunately, every one I saw was incomplete. Most began some time after the start of /r/place, and had a resolution of several minutes or worse. Thanks to a lucky break I was able to construct a complete time lapse of /r/place with 1-second resolution.</p>
<p>I was browsing the <a href="https://news.ycombinator.com/item?id=14109158">Hacker News thread</a> on /r/place and found <a href="https://news.ycombinator.com/item?id=14110015">a comment which linked to the raw place data</a> which has since been removed. Nevertheless, I had a copy to work with, so I got started. The result is a glorious 60fps timelapse with 1-second resolution that's nearly 1.5 hours long. Be warned that it starts out VERY slowly. My guess is it's the admins testing stuff.</p>
<p>Here's the <a href="https://youtu.be/BfF7gtPA5HY">9-minute time lapse on YouTube</a>. The real action starts about <a href="https://youtu.be/BfF7gtPA5HY?t=98">1:38</a> in.</p>
<!-- more -->

<h1>The Data</h1>
<p>The data was in timestamp,username,x_coordinate,y_coordinate,color tuples. If I started from the earliest timestamp I could reconstruct /r/place one second at a time! Here is a <a href="https://mega.nz/#!E0gQ2KiY!n6HnDfR8bpQz79fKv4GtTt06S4iLSBq7bDfeo-rxuUU">copy of the CSV file I used</a>. I have scrubbed the usernames. Given that the original source data was deleted, I don't want to be the guy to release usernames if releasing them was unintentional in the first place.</p>
<p>The only problem with the data is the times are to the second. If users placed pixels within the same second, it's possible that the order is going to be wrong. This is probably why my <a href="https://i.imgur.com/0NR4NRB.png">final frame</a> is slightly different from other published final frames.</p>
<p>Here's my script to generate frames from the pixel data:</p>
<p>{% codeblock lang:python render_place.py %}</p>
<h1>!/usr/bin/python</h1>
<p>import csv
from PIL import Image, ImageDraw, ImageColor
from multiprocessing import Pool</p>
<p>def save_image(image,ts):
    image.save('frames/{0}.png'.format(ts))</p>
<h1>Hex color table</h1>
<p>colors = ["#FFFFFF","#E4E4E4","#888888","#222222","#FFA7D1","#E50000","#E59500","#A06A42","#E5D900","#94E044","#02BE01","#00E5F0","#0083C7","#0000EA","#E04AFF","#820080"]</p>
<h1>Convert the colors to RGB tuples</h1>
<p>for i in range(0,len(colors)):
    colors[i]=ImageColor.getrgb(colors[i])</p>
<p>with Pool(processes=32) as pool:
    with open ('sorted_pixels.csv') as csvfile:
        reader = csv.DictReader(csvfile)
        ts = 1490918687000
        im = Image.new("RGB",(1001,1001),"white")
        pixels = im.load()
        for row in reader:
            rowTimestamp = int(row['ts'])
            for i in range(ts,rowTimestamp,1000):
                pool.apply(save_image, args=(im, i,)) </p>
<div class="highlight"><pre><span></span>        ts = rowTimestamp
        pixels[int(row[&#39;x_coordinate&#39;]),int(row[&#39;y_coordinate&#39;])] = colors[int(row[&#39;color&#39;])]
    pool.apply(save_image, args=(im,ts))
</pre></div>


<p>{% endcodeblock %}</p>
<h1>Making the Video</h1>
<p>After many hours, 16,559,898 pixel changes were converted into 320,048 PNG frames totaling 129GB. These frames can be <em>losslessly</em> composed into a 60fps mp4 using FFmpeg:</p>
<div class="highlight"><pre><span></span>ffmpeg -f image2 -r 60 -pattern_type glob -i *&quot;.png&quot; -qp 0 -vf crop=1000:1000:0:0 Place-Timelapse.mp4
</pre></div>


<p>The resulting video is about 1.5 hours long, but may be interesting for anyone looking to build their own time lapses since it has <em>every</em> frame. You can <a href="https://mega.nz/#!MxIAiByD!_FcePrDFno-Gl2CqUcLwxzzVfD3uQLwexkVRR1UULDY">download it here</a>. Be advised that many video players have trouble playing lossless x264 video (especially at 60fps). You can use Ffmpeg to extract the individual frames if you need to. You'll need at least 130gb free! Alternatively you could generate them from the raw data using my Python script. That took about 24hrs on my i3-6300.</p>
<div class="highlight"><pre><span></span>ffmpeg -i Place-Timelapse.mp4 frame_%10d.png
</pre></div>


<p>To make the version sped up 10x from that, I used:</p>
<div class="highlight"><pre><span></span>ffmpeg -f image2 -r 600 -pattern_type glob -i *&quot;.png&quot; -qp 0 -vf crop=1000:1000:0:0,fps=60 Place-Timelapse10x.mp4
</pre></div>


<p>This is the one on YouTube, but you can download the lossless version too.</p>
<h2>A note on scaling</h2>
<p>Since this is pixel art, you want to be picky about what filter to use when scaling. I recommend using no interpolation, or nearest neighbor. This preserves 
the hard edges in the art. In ffmpeg, use <code>-sws_flags neighbor</code>. For example, to make the 2000x2000 version for YouTube I used <code>-sws_flags neighbor -vf scale=iw*2:-1</code>.</p>
<h1>Archive.org</h1>
<p>I notice the <a href="https://archive.org/details/reddit-place-timelapse-daily-img-archive">data on Archive.org</a> is missing the first bits. I think a lot of folks built from that. Given that I have a more complete set of data I'm open to working with someone to preserve it, but I have no idea where to begin.</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>